{{!< default}}

{{#post}}
<main class="section post-page-layout">
  <div class="container">
    <div class="columns is-variable is-6-desktop">

      {{!-- ======== Main Content Column (Left) ======== --}}
      <div class="column is-9">
        <article class="post-article-main">
          
          <header class="post-header mb-5">
            <h1 class="title is-size-1-desktop is-size-2-tablet is-size-3-mobile has-text-weight-bold post-title">
              {{title}}
            </h1>
            <div class="is-size-6 has-text-grey mt-4">
              By <a href="{{primary_author.url}}">{{primary_author.name}}</a> on <time datetime="{{date format="YYYY-MM-DD"}}">{{date format="MMMM DD, YYYY"}}</time>
            </div>
          </header>

          {{!-- The YouTube iframe is embedded directly in a responsive container --}}
          <figure class="image is-16by9">
            <iframe 
                class="has-ratio"
                src="https://www.youtube.com/embed/{{custom_excerpt}}?rel=0" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
            </iframe>
          </figure>

          {{!-- In-Article Ad Placeholder --}}
          <div class="notification is-light has-text-centered my-6">
            <p class="has-text-grey-light">Advertisement</p>
          </div>

          {{!-- The post content from the editor renders here --}}
          <div class="content post-content-body is-medium">
            {{content}}
          </div>
          
        </article>
      </div>

      {{!-- ======== Sidebar Column (Right) ======== --}}
      <div class="column is-3">
        {{!-- 'is-sticky-top-on-desktop' is a placeholder class for the JS snippet below --}}
        <aside class="is-sticky-top-on-desktop">
          {{!-- WIDGET 1: Placeholder for Timestamps --}}
          {{!-- This is the space you will target with JavaScript later --}}
          <div class="panel mb-5">
            <p class="panel-heading">Timestamps</p>
            <div class="panel-block">
              <p class="has-text-grey">Timestamps will be generated here.</p>
            </div>
          </div>

          {{!-- WIDGET 2: Related Videos --}}
          {{!-- WIDGET 2: Related Videos (Optimized for Narrow Sidebar) --}}
{{#get "posts" filter="tags:hash-video+id:-{{id}}" limit="4" as |related|}}
  {{#if related}}
  <div>
    <h3 class="title is-5 mb-4">Related Videos</h3>
      {{#foreach related}}
        {{!-- Each item is a clickable block. This is key for good UX. --}}
        <a href="{{url}}" class="is-block mb-4">
          
          {{!-- 1. The Thumbnail --}}
          {{!-- The mb-2 adds a little space between the image and the title --}}
          <figure class="image is-16by9 mb-2">
            {{#if feature_image}}
              {{!-- If a feature image exists, use it --}}
              <img src="{{feature_image}}" alt="{{title}}" loading="lazy" style="border-radius: 4px;">
            {{else}}
              {{!-- Otherwise, use the YouTube thumbnail from the custom excerpt. --}}
              {{!-- hqdefault.jpg is a reliable and fast-loading choice for sidebars. --}}
              <img src="https://i.ytimg.com/vi/{{custom_excerpt}}/hqdefault.jpg" alt="{{title}}" loading="lazy" style="border-radius: 4px;">
            {{/if}}
          </figure>

          {{!-- 2. The Text Content --}}
          <div>
            {{!-- Using a smaller font size that's appropriate for a sidebar --}}
            <p class="is-size-6 has-text-weight-semibold has-text-dark" style="line-height: 1.3;">{{title}}</p>
            {{#if primary_author}}
              <p class="is-size-7 has-text-grey">{{primary_author.name}}</p>
            {{/if}}
          </div>
        </a>
      {{/foreach}}
  </div>
  {{/if}}
{{/get}}

          {{!-- WIDGET 3: Sidebar Advertisement Placeholder --}}
          <div class="notification is-light has-text-centered">
            <p class="has-text-grey-light">Advertisement</p>
          </div>

        </aside>
      </div>
    </div>
  </div>
</main>


{{!-- This small, embedded script makes the sidebar sticky on desktop without custom CSS --}}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.querySelector('.is-sticky-top-on-desktop');
    if (sidebar && window.innerWidth >= 1024) {
        sidebar.style.position = 'sticky';
        sidebar.style.top = '2rem'; // Adjust based on your navbar height
    }
});
</script>
{{/post}}